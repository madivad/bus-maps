<!DOCTYPE html> 
<html>
<head>
    <title>Realtime Bus Map</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="head-container">
        <div id="menu-bar">
            <button id="btn-operators">Operators</button>
            <button id="btn-routes" disabled>Routes</button> 
            <button id="btn-options">Options</button>
            <div id="small-timer"></div>
            <h3 id="map-title">Realtime Bus Positions</h3> 
        </div>
    </div>

    <div id="map"></div>

    <div id="route-sidebar" style="display:none;">
        <h4>Tracked Routes</h4>
        <div id="sidebar-routes-list">
        </div>
    </div>

    <div id="operators-modal" class="modal" style="display:none;">
        <div class="modal-content">
            <span class="close-button" id="close-operators-modal">×</span>
            <h2>Select Operators</h2>
            <div id="operators-list" class="modal-list">
            </div>
            <button id="save-operators">Save & Update</button>
        </div>
    </div>

    <div id="routes-modal" class="modal" style="display:none;">
        <div class="modal-content">
            <span class="close-button" id="close-routes-modal">×</span>
            <h2>Select Routes</h2>
            <div class="routes-modal-body-flex-container" style="display: flex; justify-content: space-between;">
                <div class="routes-list-column">
                    <div id="selected-routes-list-container">
                        <h4>Selected Routes:</h4>
                        <div id="selected-routes-list" class="modal-list fixed-list">
                        </div>
                    </div>
                    <hr>
                    <h4>Available Routes: <span id="available-routes-count"></span></h4>
                    <input type="text" id="route-search-input" placeholder="Search routes..." style="width: 95%; margin-bottom: 10px;">
                    <div id="available-routes-list" class="modal-list scrollable-list">
                    </div>
                </div>
                <div id="route-preview-container" style="border: 1px solid #ccc; margin-left: 15px; min-height: 200px; display: flex; align-items: center; justify-content: center; text-align: center;">
                    Click an available route to preview its path.
                </div>
            </div>
            <button id="save-routes" style="margin-top: 15px;">Save & Update Map</button>
        </div>
    </div>

    <div id="options-modal" class="modal" style="display:none;">
        <div class="modal-content">
            <span class="close-button" id="close-options-modal">×</span>
            <h2>Map Options</h2>
            <div id="options-content-area">
                <div class="option-item">
                    <label for="update-frequency">Update Frequency:</label>
                    <select id="update-frequency">
                        <option value="10000">10 seconds</option>
                        <option value="20000" selected>20 seconds</option>
                        <option value="30000">30 seconds</option>
                        <option value="60000">1 minute</option>
                    </select>
                </div>
                <hr>
                <div class="option-item">
                    <label>
                        <input type="checkbox" id="toggle-live-tracking" checked>
                        Enable Live Bus Tracking
                    </label>
                </div>
                <hr>
                <div class="option-item">
                    <label>
                        <input type="checkbox" id="toggle-route-paths" checked>
                        Show Route Paths
                    </label>
                </div>
            </div>
            <button id="save-options">Apply & Save Options</button>
        </div>
    </div>

    <script type="module" src="{{ url_for('static', filename='map_init.js') }}"></script>
</body>
</html>